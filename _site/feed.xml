<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-01-05T14:20:12+09:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Bibliothek f√ºr Data-Engineering</title><subtitle>Eine Bibliothek</subtitle><author><name>ZSU</name></author><entry><title type="html">[PySpark] DataFrame Basics</title><link href="http://localhost:4000/pyspark/pyspark1/" rel="alternate" type="text/html" title="[PySpark] DataFrame Basics" /><published>2022-01-05T00:00:00+09:00</published><updated>2022-01-05T00:00:00+09:00</updated><id>http://localhost:4000/pyspark/pyspark1</id><content type="html" xml:base="http://localhost:4000/pyspark/pyspark1/">&lt;hr /&gt;
&lt;h3 id=&quot;pyspark-dataframe-basics&quot;&gt;PySpark DataFrame Basics&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;PySpark Basic1&lt;/li&gt;
  &lt;li&gt;DataFrame Schema&lt;/li&gt;
  &lt;li&gt;PySpark Basic2&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;pyspark-basic1&quot;&gt;PySpark Basic1&lt;/h3&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# start spark session by applying it
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SparkSession&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;builder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Basics&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getOrCreate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# read data
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;people.json&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# show dataframe
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+-------+
| age|   name|
+----+-------+
|null|Michael|
|  30|   Andy|
|  19| Justin|
+----+-------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# show df schema
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printSchema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root
 |-- age: long (nullable = true)
 |-- name: string (nullable = true)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# show df columns
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;['age', 'name']
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# get summary of df
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DataFrame[summary: string, age: string, name: string]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# # get statiscal summary of df
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+-------+------------------+-------+
|summary|               age|   name|
+-------+------------------+-------+
|  count|                 2|      3|
|   mean|              24.5|   null|
| stddev|7.7781745930520225|   null|
|    min|                19|   Andy|
|    max|                30|Michael|
+-------+------------------+-------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;dataframe-schema&quot;&gt;DataFrame Schema&lt;/h3&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pyspark.sql.types&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# third parameter true - no data will be null
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_schema&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IntegerType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
               &lt;span class=&quot;n&quot;&gt;StructField&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StringType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;final_struc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StructType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fields&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_schema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'people.json'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schema&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;final_struc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;printSchema&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;root
 |-- age: integer (nullable = true)
 |-- name: string (nullable = true)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;pyspark-basic2&quot;&gt;PySpark Basic2&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;selecting a column&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# select column from a df
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Column&amp;lt;'age'&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pyspark.sql.column.Column
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# select a column of a df as a df
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DataFrame[age: int]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+
| age|
+----+
|null|
|  30|
|  19|
+----+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pyspark.sql.dataframe.DataFrame
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# selecting multiple columns
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DataFrame[age: int, name: string]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;selecting a row&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Row(age=None, name='Michael')
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pyspark.sql.types.Row
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;mutate&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;double_age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+----+-------+----------+
| age|   name|double_age|
+----+-------+----------+
|null|Michael|      null|
|  30|   Andy|        60|
|  19| Justin|        38|
+----+-------+----------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;rename&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;withColumnRenamed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;new_age&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+-------+-------+
|new_age|   name|
+-------+-------+
|   null|Michael|
|     30|   Andy|
|     19| Justin|
+-------+-------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;sql in Spark&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# make a temporary view
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;createOrReplaceTempView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;people&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# query
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spark&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SELECT * FROM people WHERE age = 30&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;+---+----+
|age|name|
+---+----+
| 30|Andy|
+---+----+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;</content><author><name>ZSU</name></author><category term="PYSPARK" /><category term="PYTHON" /><category term="PYSPARK" /><category term="DOCKER" /><summary type="html">PySpark DataFrame Basics PySpark Basic1 DataFrame Schema PySpark Basic2</summary></entry><entry><title type="html">[Docker] Docker Jupyter Notebook &amp;amp; PySpark</title><link href="http://localhost:4000/docker/docker3/" rel="alternate" type="text/html" title="[Docker] Docker Jupyter Notebook &amp;amp; PySpark" /><published>2022-01-05T00:00:00+09:00</published><updated>2022-01-05T00:00:00+09:00</updated><id>http://localhost:4000/docker/docker3</id><content type="html" xml:base="http://localhost:4000/docker/docker3/">&lt;h3 id=&quot;docker---jupyter-notebook--pyspark&quot;&gt;Docker - Jupyter Notebook &amp;amp; PySpark&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# run container&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; jupyter_pyspark &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 10000:8888 &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;:/home/jovyan/work jupyter/pyspark-notebook:latest

&lt;span class=&quot;c&quot;&gt;# stop container&lt;/span&gt;
docker container stop jupyter_pyspark

&lt;span class=&quot;c&quot;&gt;# restart container&lt;/span&gt;
docker start &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; jupyter_pyspark
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;ref&quot;&gt;ref&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://hub.docker.com/r/jupyter/pyspark-notebook&quot;&gt;üîó Docker Hub&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jupyter-docker-stacks.readthedocs.io/en/latest/using/specifics.html#apache-spark&quot;&gt;üîó Docker-Jupyter Í≥µÏãù Î¨∏ÏÑú1&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://jupyter-docker-stacks.readthedocs.io/en/latest/using/running.html&quot;&gt;üîó Docker-Jupyter Í≥µÏãù Î¨∏ÏÑú2&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://pearlluck.tistory.com/615&quot;&gt;üîó Ï∞∏Í≥† Î∏îÎ°úÍ∑∏&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>ZSU</name></author><category term="DOCKER" /><category term="DOCKER" /><summary type="html">Docker - Jupyter Notebook &amp;amp; PySpark ```bash run container docker container run ‚Äìname jupyter_pyspark -p 10000:8888 -v $(pwd):/home/jovyan/work jupyter/pyspark-notebook:latest</summary></entry><entry><title type="html">[Docker] Docker Compose</title><link href="http://localhost:4000/docker/docker_udemy9/" rel="alternate" type="text/html" title="[Docker] Docker Compose" /><published>2022-01-04T00:00:00+09:00</published><updated>2022-01-04T00:00:00+09:00</updated><id>http://localhost:4000/docker/docker_udemy9</id><content type="html" xml:base="http://localhost:4000/docker/docker_udemy9/">&lt;hr /&gt;
&lt;h3 id=&quot;docker-compose&quot;&gt;Docker Compose&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Basic Docker compose commands&lt;/li&gt;
  &lt;li&gt;Build a Compose File For a Multi-Container Service&lt;/li&gt;
  &lt;li&gt;Compose for Run-Time Building and Multi-Container Development&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;basic-docker-compose-commands&quot;&gt;Basic Docker compose commands&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# pwdÏóê docker-compose.yml Ï°¥Ïû¨, docker-compose ÏãúÏûë (docker compose up)&lt;/span&gt;
docker-compose up

&lt;span class=&quot;c&quot;&gt;# docker compose Ï¢ÖÎ£å (docker-compose down)&lt;/span&gt;
docker-compose down
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;build-a-compose-file-for-a-multi-container-service&quot;&gt;Build a Compose File FOr a Multi-Container Service&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;build a drupal content management system&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# use Drupal image along with postgres image&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# use ports to expose Drupal on 8060 for localhost:8060&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# set POSTGRES_PASSWORD for postgres&lt;/span&gt;
version: &lt;span class=&quot;s1&quot;&gt;'2'&lt;/span&gt;

services:
  drupal:
    image: drupal
    ports:
      - 8050:80
    volumes:
      - /var/www/html/modules
      - /var/www/html/profiles
      - /var/www/html/themes
      - /var/www/html/sites

  postgres:
    image: postgres
    environment: 
       - &lt;span class=&quot;nv&quot;&gt;POSTGRES_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1234
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Drupal DB&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# walk through Drupal via browser&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Drupal assumes DB is localhost so it has to be changed to 'postgres'&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# volumeÍπåÏßÄ ÏÇ≠Ï†ú&lt;/span&gt;
docker-compose down &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;compose-for-run-time-building-and-multi-container-development&quot;&gt;Compose for Run-Time Building and Multi-Container Development&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Build custom drupal image for local testing&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# assignment instruction&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## Dockerfile&lt;/span&gt;
- First you need to build a custom Dockerfile &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this directory, &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;FROM drupal:8.8.2&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; NOTE: &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;it fails to build, try the latest 8 branch version with &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;FROM drupal:8&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
- Then RUN apt package manager &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;to &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;git: &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;apt-get update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; git&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
- Remember to cleanup after your apt &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;with &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; /var/lib/apt/lists/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; and use &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\`&lt;/span&gt; and &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; properly. You can find examples of them &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;drupal official image. More on this below under Compose file.
- Then change &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;WORKDIR /var/www/html/themes&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
- Then use git to clone the theme with: &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;RUN git clone &lt;span class=&quot;nt&quot;&gt;--branch&lt;/span&gt; 8.x-3.x &lt;span class=&quot;nt&quot;&gt;--single-branch&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--depth&lt;/span&gt; 1 https://git.drupalcode.org/project/bootstrap.git&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
- Combine that line with this line, as we need to change permissions on files and don&lt;span class=&quot;s1&quot;&gt;'t want to use another image layer to do that (it creates size bloat). This drupal container runs as www-data user but the build actually runs as root, so often we have to do things like `chown` to change file owners to the proper user: `chown -R www-data:www-data bootstrap`. Remember the first line needs a `\` at end to signify the next line is included in the command, and at start of next line you should have `&amp;amp;&amp;amp;` to signify &quot;if first command succeeds then also run this command&quot;
- Then, just to be safe, change the working directory back to its default (from drupal image) at `/var/www/html`

## Compose File
- We'&lt;/span&gt;re going to build a custom image &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this compose file &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;drupal service. Use Compose file from previous assignment &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;Drupal to start with, and we&lt;span class=&quot;s1&quot;&gt;'ll add to it, as well as change image name.
- Rename image to `custom-drupal` as we want to make a new image based on the official `drupal:8.8.2`.
- We want to build the default Dockerfile in this directory by adding `build: .` to the `drupal` service. When we add a build + image value to a compose service, it knows to use the image name to write to in our image cache, rather then pull from Docker Hub.
- For the `postgres:12.1` service, you need the same password as in previous assignment, but also add a volume for `drupal-data:/var/lib/postgresql/data` so the database will persist across Compose restarts.

## Start Containers, Configure Drupal
- Start containers like before, configure Drupal web install like before.
- After website comes up, click on `Appearance` in top bar, and notice a new theme called `Bootstrap` is there. That'&lt;/span&gt;s the one we added with our custom Dockerfile.
- Click &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;Install and &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;as default&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Then click &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;Back to site&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;top left&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and the website interface should look different. You&lt;span class=&quot;s1&quot;&gt;'ve successfully installed and activated a new theme in your own custom image without installing anything on your host other than Docker!
- If you exit (ctrl-c) and then `docker-compose down` it will delete containers, but not the volumes, so on next `docker-compose up` everything will be as it was.
- To totally clean up volumes, add `-v` to `down` command.
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Dockerfile&lt;/span&gt;
FROM drupal:8.8.2

RUN apt-get update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; git &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-rf&lt;/span&gt; /var/lib/apt/lists/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

WORKDIR /var/www/html/themes

RUN git clone &lt;span class=&quot;nt&quot;&gt;--branch&lt;/span&gt; 8.x-3.x &lt;span class=&quot;nt&quot;&gt;--single-branch&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--depth&lt;/span&gt; 1 https://git.drupalcode.org/project/bootstrap.git &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chown&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; www-data:www-data bootstrap

WORKDIR /var/www/html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# docker-compose.yml&lt;/span&gt;
version: &lt;span class=&quot;s1&quot;&gt;'2'&lt;/span&gt;

services:
  drupal:
    image: custom-drupal
    build: &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
    ports:
      - 8050:80
    volumes:
      - /var/www/html/modules
      - /var/www/html/profiles
      - /var/www/html/themes
      - /var/www/html/sites


  postgres:
    image: postgres:12.1
    environment: 
      - &lt;span class=&quot;nv&quot;&gt;POSTGRES_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1234
    volumes:
      - drupal-data:/var/lib/postgresql/data

volumes:
  drupal-data:
  drupal-modules:
  drupal-profiles:
  drupal-themes:
  drupal-sites:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>ZSU</name></author><category term="DOCKER" /><category term="DOCKER" /><summary type="html">Docker Compose Basic Docker compose commands Build a Compose File For a Multi-Container Service Compose for Run-Time Building and Multi-Container Development</summary></entry><entry><title type="html">[Docker] Docker Prune</title><link href="http://localhost:4000/docker/docker_udemy7/" rel="alternate" type="text/html" title="[Docker] Docker Prune" /><published>2022-01-04T00:00:00+09:00</published><updated>2022-01-04T00:00:00+09:00</updated><id>http://localhost:4000/docker/docker_udemy7</id><content type="html" xml:base="http://localhost:4000/docker/docker_udemy7/">&lt;hr /&gt;
&lt;h3 id=&quot;docker-cleaning-up&quot;&gt;Docker Cleaning Up&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;prune command to clean up images, volumes, build cache, and containers&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;docker-clean-up&quot;&gt;Docker clean up&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# displays information regarding the amount of disk space used by the docker daemon&lt;/span&gt;
docker system &lt;span class=&quot;nb&quot;&gt;df&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Remove all unused containers, networks, images (both dangling and unreferenced), and optionally, volumes&lt;/span&gt;
docker system prune

docker image prune
docker container prune
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;ref&quot;&gt;ref&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.docker.com/engine/reference/commandline/system_prune/&quot;&gt;üîó Í≥µÏãù Î¨∏ÏÑú&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.lainyzine.com/ko/article/docker-prune-usage-remove-unused-docker-objects/&quot;&gt;üîó Ï∞∏Í≥† Î∏îÎ°úÍ∑∏&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>ZSU</name></author><category term="DOCKER" /><category term="DOCKER" /><summary type="html">Docker Cleaning Up prune command to clean up images, volumes, build cache, and containers</summary></entry><entry><title type="html">[Docker] Docker Persistent Data</title><link href="http://localhost:4000/docker/docker_udemy8/" rel="alternate" type="text/html" title="[Docker] Docker Persistent Data" /><published>2022-01-04T00:00:00+09:00</published><updated>2022-01-04T00:00:00+09:00</updated><id>http://localhost:4000/docker/docker_udemy8</id><content type="html" xml:base="http://localhost:4000/docker/docker_udemy8/">&lt;hr /&gt;
&lt;h3 id=&quot;docker-persistent-data&quot;&gt;Docker Persistent Data&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;containers are usually immutable(unchangeable) &amp;amp; ephemeral(temporary)&lt;/li&gt;
  &lt;li&gt;which means that containers should never change when containers are re-deployed&lt;/li&gt;
  &lt;li&gt;then the problem arises for unique data like databases&lt;/li&gt;
  &lt;li&gt;these unique data are called persistent data&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Data Volumes&lt;/strong&gt; &amp;amp; &lt;strong&gt;Bind Mounts&lt;/strong&gt; is used to solve the problem&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Data Volumes&lt;/strong&gt; - configuration option that creates a special locations outside the container‚Äôs union file system to store unique data&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Bind Mounts&lt;/strong&gt; - sharing or mounting a host directory or file into a container&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;data-volumes&quot;&gt;Data Volumes&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# pull mysql image &lt;/span&gt;
docker image pull mysql:latest

&lt;span class=&quot;c&quot;&gt;# run container&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; mysql_test &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_ALLOW_EMPTY_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;true &lt;/span&gt;mysql:latest

&lt;span class=&quot;c&quot;&gt;# mysql_test containerÏùò ÏÑ§Ï†ï Î∂ÄÎ∂Ñ, ÏÑ§Ï†ï Ï§ë volumeÏùÑ ÌôïÏù∏&lt;/span&gt;
docker container inspect mysql_test
&lt;span class=&quot;c&quot;&gt;# destination - containerÍ∞Ä Îç∞Ïù¥ÌÑ∞Î•º Ï†ÅÏû¨ÌïúÎã§Í≥† ÏÉùÍ∞ÅÌïòÎäî Í≥≥&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# source - Ïã§Ï†ú Îç∞Ïù¥ÌÑ∞Í∞Ä Ï†ÅÎåÄÎêòÏñ¥ ÏûàÎäî Í≥≥&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# docker containerÎ•º ÌÜµÌï¥ ÎßåÎì† Î™®Îì† Îç∞Ïù¥ÌÑ∞Î•º ÌôïÏù∏Ìï† Ïàò ÏûàÏùå, Ïù¥ volumeÏùÄ containerÍ∞Ä ÏÇ≠Ï†úÎêòÏñ¥ÎèÑ ÎÇ®ÏïÑ ÏûàÏùå&lt;/span&gt;
docker volume &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ÌïòÏßÄÎßå volumeÏù¥ Ïñ¥Îñ§ volumeÏù∏ÏßÄ Î∂ÑÍ∞ÑÌïòÍ∏∞Í∞Ä Ïñ¥Î†µÍ∏∞Ïóê containerÏùÑ runÌï† Îïå volumeÏóê nameÏùÑ Ï£ºÎäî Í≤ÉÏù¥ Ï¢ãÏùå&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; mysql_test1 &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_ALLOW_EMPTY_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; mysql-db:/var/lib/mysql mysql:latest

&lt;span class=&quot;c&quot;&gt;# mysql_test2ÎèÑ mysql_test1Í≥º Í∞ôÏùÄ dbÎ•º ÏÇ¨Ïö©&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; mysql_test2 &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;MYSQL_ALLOW_EMPTY_PASSWORD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; mysql-db:/var/lib/mysql mysql:latest
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;database-upgrade-practice-using-named-volumes&quot;&gt;Database Upgrade Practice Using Named Volumes&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Upgrading Database with Named Volumes&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# create a postgres container with named volume psql-data using version 9.6.1&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; postgres_test1 &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; psql-data:/var/lib/postgresql/data postgres:9.6.1

&lt;span class=&quot;c&quot;&gt;# check log &amp;amp; stop container&lt;/span&gt;
docker container logs postgres_test1
docker container stop postgres_test1

&lt;span class=&quot;c&quot;&gt;# create a new postgres container with same named volume psql-data using version 9.6.2&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; postgres_test2 &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; psql-data:/var/lib/postgresql/data postgres:9.6.2

&lt;span class=&quot;c&quot;&gt;# check log &amp;amp; stop container&lt;/span&gt;
docker container logs postgres_test2
docker container stop postgres_test2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;bind-mounts&quot;&gt;Bind Mounts&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# (terminal1) pwdÏóê index.html Ï°¥Ïû¨ ($(pwd)Îäî ÌòÑÏû¨ pwd, Ï¶â ÌòÑÏû¨ wdÏôÄ colon Îí§ containerÏùò wdÎ•º ÏùºÏπòÏãúÌÇ¨ Í≤ÉÏûÑ)&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; nginx &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 80:80 &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;pwd&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;:/usr/share/nginx/html nginx

&lt;span class=&quot;c&quot;&gt;# (terminal2) open a new terminal (command+shift+d)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# (terminal2) get a shell inside nginx container&lt;/span&gt;
docker container &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; nginx bash

&lt;span class=&quot;c&quot;&gt;# (terminal2) cd&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;usr/share/nginx/html
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-al&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# - you can see Dockerfile &amp;amp; index.html&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# (terminal1) make a new file in the original wd&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;touch &lt;/span&gt;test.txt

&lt;span class=&quot;c&quot;&gt;# (terminal2)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-al&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# - you can see the test.txt file!&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;</content><author><name>ZSU</name></author><category term="DOCKER" /><category term="DOCKER" /><summary type="html">Docker Persistent Data containers are usually immutable(unchangeable) &amp;amp; ephemeral(temporary) which means that containers should never change when containers are re-deployed then the problem arises for unique data like databases these unique data are called persistent data Data Volumes &amp;amp; Bind Mounts is used to solve the problem Data Volumes - configuration option that creates a special locations outside the container‚Äôs union file system to store unique data Bind Mounts - sharing or mounting a host directory or file into a container</summary></entry><entry><title type="html">[Docker] Docker Image2 - Building Images</title><link href="http://localhost:4000/docker/docker_udemy6/" rel="alternate" type="text/html" title="[Docker] Docker Image2 - Building Images" /><published>2022-01-03T00:00:00+09:00</published><updated>2022-01-03T00:00:00+09:00</updated><id>http://localhost:4000/docker/docker_udemy6</id><content type="html" xml:base="http://localhost:4000/docker/docker_udemy6/">&lt;hr /&gt;
&lt;h3 id=&quot;docker-image2---building-images&quot;&gt;Docker Image2 - Building Images&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Dockerfile Build&lt;/li&gt;
  &lt;li&gt;Dockerfile Build Example&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;dockerfile-build&quot;&gt;Dockerfile Build&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# DockerfileÏù¥ ÏûàÎäî repositoryÏóêÏÑú ÏßÑÌñâ (docker image build -t [image_name] .)&lt;/span&gt;
docker image build &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; custom_nginx &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# dockerfileÏóê Ï†ÅÌòÄ ÏûàÎäî ÏàúÏÑúÎåÄÎ°ú buildÌïòÎ©∞, Î≥ÄÍ≤ΩÏù¥ ÏóÜÎäî Î∂ÄÎ∂ÑÏùÄ cacheÎ•º Ïù¥Ïö©ÌïòÍ≥† Î≥ÄÍ≤ΩÎêú Î∂ÄÎ∂ÑÎßå ÏÉàÎ°≠Í≤å buildÌïòÎØÄÎ°ú&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Î≥ÄÍ≤ΩÏù¥ ÏóÜÎäî Î∂ÄÎ∂ÑÏùÑ ÏúÑÏóê, Î≥ÄÍ≤ΩÏù¥ ÎßéÏùÄ Î∂ÄÎ∂ÑÏùÄ ÏïÑÎûòÏóê Ï†ÅÎäî Í≤ÉÏù¥ Ï¢ãÏùå&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;dockerfile-build-example&quot;&gt;Dockerfile Build Example&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Dockerfile&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# - you should use the 'node' official image, with the alpine 6.x branch (node:6-alpine)&lt;/span&gt;
FROM node:6-alpine
&lt;span class=&quot;c&quot;&gt;# - this app listens on port 3000, but the container should launch on port 80&lt;/span&gt;
EXPOSE 3000
&lt;span class=&quot;c&quot;&gt;# - then it should use alpine package manager to install tini: 'apk add --update tini'&lt;/span&gt;
RUN apk add &lt;span class=&quot;nt&quot;&gt;--update&lt;/span&gt; tini
&lt;span class=&quot;c&quot;&gt;# - then it should create directory /usr/src/app for app files with 'mkdir -p /usr/src/app'&lt;/span&gt;
RUN &lt;span class=&quot;nb&quot;&gt;mkdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; /usr/src/app
&lt;span class=&quot;c&quot;&gt;# - Node uses a &quot;package manager&quot;, so it needs to copy in package.json file&lt;/span&gt;
WORKDIR /usr/src/app
COPY package.json package.json 
&lt;span class=&quot;c&quot;&gt;# - then it needs to run 'npm install' to install dependencies from that file&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# - to keep it clean and small, run 'npm cache clean --force' after above&lt;/span&gt;
RUN npm &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; npm cache clean &lt;span class=&quot;nt&quot;&gt;--force&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# - then it needs to copy in all files from current directory&lt;/span&gt;
COPY &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# - then it needs to start container with command '/sbin/tini -- node ./bin/www'&lt;/span&gt;
CMD &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;tini&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;--&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;node&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;./bin/www&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;localÏóêÏÑú ÌôïÏù∏&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# build&lt;/span&gt;
docker build &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; testnode &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# run container&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;--rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 80:3000 testnode

&lt;span class=&quot;c&quot;&gt;# check&lt;/span&gt;
localhost:80

&lt;span class=&quot;c&quot;&gt;# docker hubÏóê Ïò¨Î¶¨Í≥† download&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;docker hubÏóê Ïò¨Î¶∞ Îí§, pullÌï¥ÏÑú ÌôïÏù∏&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# docker image tagging&lt;/span&gt;
docker tag testnode:latest carl020958/testing_node:latest

&lt;span class=&quot;c&quot;&gt;# pushing to docker hub&lt;/span&gt;
docker push carl020958/testing_node:latest

&lt;span class=&quot;c&quot;&gt;# remove docker image&lt;/span&gt;
docker image &lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; 3b6

&lt;span class=&quot;c&quot;&gt;# run container&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;--rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 80:3000 carl020958/testing_node

&lt;span class=&quot;c&quot;&gt;# check&lt;/span&gt;
localhost:80
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;</content><author><name>ZSU</name></author><category term="DOCKER" /><category term="DOCKER" /><summary type="html">Docker Image2 - Building Images Dockerfile Build Dockerfile Build Example</summary></entry><entry><title type="html">[Docker] Docker Network2</title><link href="http://localhost:4000/docker/docker_udemy4/" rel="alternate" type="text/html" title="[Docker] Docker Network2" /><published>2022-01-03T00:00:00+09:00</published><updated>2022-01-03T00:00:00+09:00</updated><id>http://localhost:4000/docker/docker_udemy4</id><content type="html" xml:base="http://localhost:4000/docker/docker_udemy4/">&lt;hr /&gt;
&lt;h3 id=&quot;docker-network2&quot;&gt;Docker Network2&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Docker CLI Testing&lt;/li&gt;
  &lt;li&gt;Docker DNS Round Robin Test&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;docker-cli-testing&quot;&gt;Docker CLI Testing&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# centos7&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# --rm optionÏùÑ ÌÜµÌï¥ Ìï¥Îãπ container Ï¢ÖÎ£å Ïãú ÏûêÎèô ÏÇ≠Ï†ú&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;--rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; centos:7 bash

&lt;span class=&quot;c&quot;&gt;# root&lt;/span&gt;
yum update curl

curl &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ubuntu14.04&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;--rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; ubuntu:14.04 bash

&lt;span class=&quot;c&quot;&gt;# root&lt;/span&gt;
apt-get update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; curl

curl--version
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;docker-dns-round-robin-test&quot;&gt;Docker DNS Round Robin Test&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# create network &lt;/span&gt;
docker network create dns_test

&lt;span class=&quot;c&quot;&gt;# create 2 elasticsearch:2 container in dns_test network&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; dns_test &lt;span class=&quot;nt&quot;&gt;--net-alias&lt;/span&gt; search elasticsearch:2
docker container run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; dns_test &lt;span class=&quot;nt&quot;&gt;--net-alias&lt;/span&gt; search elasticsearch:2

&lt;span class=&quot;c&quot;&gt;# use the code below to test DNS Round Robin 1&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;--rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; dns_test alpine:3.10 nslookup search

&lt;span class=&quot;c&quot;&gt;# use the code below to test DNS Round Robin 2&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;--rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--net&lt;/span&gt; dns_test centos curl &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; search:9200
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;</content><author><name>ZSU</name></author><category term="DOCKER" /><category term="DOCKER" /><summary type="html">Docker Network2 Docker CLI Testing Docker DNS Round Robin Test</summary></entry><entry><title type="html">[Docker] Docker Image1</title><link href="http://localhost:4000/docker/docker_udemy5/" rel="alternate" type="text/html" title="[Docker] Docker Image1" /><published>2022-01-03T00:00:00+09:00</published><updated>2022-01-03T00:00:00+09:00</updated><id>http://localhost:4000/docker/docker_udemy5</id><content type="html" xml:base="http://localhost:4000/docker/docker_udemy5/">&lt;hr /&gt;
&lt;h3 id=&quot;docker-image1&quot;&gt;Docker Image1&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Docker Image &amp;amp; Layers&lt;/li&gt;
  &lt;li&gt;Docker Image Tagging &amp;amp; Pushing to Docker Hub&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;docker-image--layers&quot;&gt;Docker Image &amp;amp; Layers&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# show history of image layers (docker image history [image_name])&lt;/span&gt;
docker image &lt;span class=&quot;nb&quot;&gt;history &lt;/span&gt;nginx:latest

&lt;span class=&quot;c&quot;&gt;# returns JSON metadata about the image (docker image inspect [image_name])&lt;/span&gt;
docker image inspect nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;docker-image-tagging--pushing-to-docker-hub&quot;&gt;Docker Image Tagging &amp;amp; Pushing to Docker Hub&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# assigns one or more tags to an image (docker image tag [source_image[:tag]] [target_image[:tag]]&lt;/span&gt;
docker image tag nginx zsu/nginx

&lt;span class=&quot;c&quot;&gt;# login to docker hub&lt;/span&gt;
docker login

&lt;span class=&quot;c&quot;&gt;# can check docker profile&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; .docker/config.json

&lt;span class=&quot;c&quot;&gt;# push to dockerhub (docker image push [user]/[image_name]:[tag])&lt;/span&gt;
docker image push zsu/nginx:testing

&lt;span class=&quot;c&quot;&gt;# login to docker hub stores authentication key, so don't forget to logout to protect your account&lt;/span&gt;
docker &lt;span class=&quot;nb&quot;&gt;logout&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;</content><author><name>ZSU</name></author><category term="DOCKER" /><category term="DOCKER" /><summary type="html">Docker Image1 Docker Image &amp;amp; Layers Docker Image Tagging &amp;amp; Pushing to Docker Hub</summary></entry><entry><title type="html">[Docker] Docker Network1</title><link href="http://localhost:4000/docker/docker_udemy3/" rel="alternate" type="text/html" title="[Docker] Docker Network1" /><published>2022-01-02T00:00:00+09:00</published><updated>2022-01-02T00:00:00+09:00</updated><id>http://localhost:4000/docker/docker_udemy3</id><content type="html" xml:base="http://localhost:4000/docker/docker_udemy3/">&lt;hr /&gt;
&lt;h3 id=&quot;docker-network1&quot;&gt;Docker Network1&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Priate &amp;amp; Pulbic Comms in Containers&lt;/li&gt;
  &lt;li&gt;CLI Management of Virtual Networks&lt;/li&gt;
  &lt;li&gt;Docker DNS(Domain Name System) &amp;amp; How Containers Find Each Other&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;priate--pulbic-comms-in-containers&quot;&gt;Priate &amp;amp; Pulbic Comms in Containers&lt;/h3&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 80:80 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; webhost &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; nginx

&lt;span class=&quot;c&quot;&gt;# Ïñ¥Îñ§ host portÏóêÏÑú container portÏúºÎ°ú forwardÎêòÎäîÏßÄ ÌôïÏù∏ (docker container port [container_name(id)])&lt;/span&gt;
docker container port webhost

&lt;span class=&quot;c&quot;&gt;# get container IP (docker container inspect --format '{{ NetWorkSettings.IPAddress }}' [container_name(id)])&lt;/span&gt;
docker container inspect &lt;span class=&quot;nt&quot;&gt;--format&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{{ .NetworkSettings.IPAddress }}'&lt;/span&gt; webhost

&lt;span class=&quot;c&quot;&gt;# check my ip&lt;/span&gt;
ipconfig getifaddr en0

&lt;span class=&quot;c&quot;&gt;# container IP and my IP is different!&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;cli-management-of-virtual-networks&quot;&gt;CLI Management of Virtual Networks&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# show network list&lt;/span&gt;
docker network &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# inspect a network (docker container inspect [network_name])&lt;/span&gt;
docker network inspect bridge

&lt;span class=&quot;c&quot;&gt;# create a network (docker network create --driver), default driver == bridge&lt;/span&gt;
docker network create my_app_net

&lt;span class=&quot;c&quot;&gt;# my_app_net networkÏóê container ÏÉùÏÑ± (--network optionÏùÑ ÌÜµÌï¥ ÏßÄÏ†ï)&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; new_nginx &lt;span class=&quot;nt&quot;&gt;--network&lt;/span&gt; my_app_net nginx

&lt;span class=&quot;c&quot;&gt;# ÌôïÏù∏&lt;/span&gt;
docker network inspect my_app_net

&lt;span class=&quot;c&quot;&gt;# attach a network to container (docker container connect [network_name(id)] [container_name(id)])&lt;/span&gt;
docker network connect a123acbd7d0a webhost

&lt;span class=&quot;c&quot;&gt;# detach a network from container (docker container disconnect [network_name(id)] [container_name(id)])&lt;/span&gt;
docker network disconnect a123acbd7d0a webhost
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;docker-dnsdomain-name-system--how-containers-find-each-other&quot;&gt;Docker DNS(Domain Name System) &amp;amp; How Containers Find Each Other&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ÌòÑÏû¨ my_app_netÏù¥ÎùºÎäî networkÏóê new_nginxÏù¥ÎùºÎäî containerÎßå Ï°¥Ïû¨&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# create my_nginx container in my_app_net network&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; my_nginx &lt;span class=&quot;nt&quot;&gt;--network&lt;/span&gt; my_app_net nginx:alpine

&lt;span class=&quot;c&quot;&gt;# send ping from my_nginx to new_nginx (available cuz they are in the same network my_app_net)&lt;/span&gt;
docker container &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; my_nginx ping new_nginx

&lt;span class=&quot;c&quot;&gt;# recommended to create custom network, docker compose makes this easier&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;hr /&gt;</content><author><name>ZSU</name></author><category term="DOCKER" /><category term="DOCKER" /><summary type="html">Docker Network1 Priate &amp;amp; Pulbic Comms in Containers CLI Management of Virtual Networks Docker DNS(Domain Name System) &amp;amp; How Containers Find Each Other</summary></entry><entry><title type="html">[Docker] Docker Shell Inside Containers</title><link href="http://localhost:4000/docker/docker_udemy2/" rel="alternate" type="text/html" title="[Docker] Docker Shell Inside Containers" /><published>2022-01-02T00:00:00+09:00</published><updated>2022-01-02T00:00:00+09:00</updated><id>http://localhost:4000/docker/docker_udemy2</id><content type="html" xml:base="http://localhost:4000/docker/docker_udemy2/">&lt;h3 id=&quot;getting-a-shell-inside-containers&quot;&gt;Getting a Shell Inside Containers&lt;/h3&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# start new container interactively (docker container run -it)&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt; proxy nginx

&lt;span class=&quot;c&quot;&gt;# run additional command in existing container (docker container exec -it)&lt;/span&gt;
docker container &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; proxy bash


&lt;span class=&quot;c&quot;&gt;# ------&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Ubuntu&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ------&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# execÏùò Í≤ΩÏö∞ÏóêÎäî additional command, startÏùò Í≤ΩÏö∞ÏóêÎäî Ìï¥Îãπ containerÎ•º ÏãúÏûë, ÎòêÌïú ubuntuÎäî argumentÎ°ú bash Ï§Ñ ÌïÑÏöî ÏóÜÏùå&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ubuntu containerÎäî Ïù¥ÎØ∏ ÏÑ§ÏπòÎêòÏñ¥ ÏûàÏùå&lt;/span&gt;
docker container start &lt;span class=&quot;nt&quot;&gt;-ai&lt;/span&gt; ubuntu

&lt;span class=&quot;c&quot;&gt;# container ÏïàÏùò ubuntuÎäî ÏùºÎ∞òÏ†ÅÏù∏ ubuntuÏôÄ Îã§Î•¥Í≤å minimalÌï®, Îî∞ÎùºÏÑú ÏïÑÎûòÏ≤òÎüº ÌïÑÏöîÌïú Î∂ÄÎ∂ÑÎì§ÏùÄ Îî∞Î°ú ÏÑ§ÏπòÍ∞Ä ÌïÑÏöî&lt;/span&gt;
apt-get update
apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; curl


&lt;span class=&quot;c&quot;&gt;# -----&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Mysql&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -----&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# mysql shellÏóêÏÑú ps Ïã§ÌñâÌïòÍ≥† Ïã∂ÏùÄ Í≤ΩÏö∞&lt;/span&gt;
apt-get update &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; procps
ps


&lt;span class=&quot;c&quot;&gt;# ------&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Alpine&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ------&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# alpineÏùÄ Í∏∞Î≥∏Ï†ÅÏúºÎ°ú bashÍ∞Ä ÏóÜÍ∏∞Ïóê shÎ°ú Ï†ëÏÜç&lt;/span&gt;
docker container run &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; alpine sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;</content><author><name>ZSU</name></author><category term="DOCKER" /><category term="DOCKER" /><summary type="html">Getting a Shell Inside Containers ```bash start new container interactively (docker container run -it) docker container run -it ‚Äìname proxy nginx</summary></entry></feed>